--- 
title: 'NFIRS 2015 is Vastly Improved: Just Ask FEMA' 
author: "Dov Chelst" 
date: '2018-02-08'
description: ''
slug: nfirs-2015-improved
tags:
- nfirs
- fire
categories: []
topics: []
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/datatables-binding/datatables.js"></script>
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="/rmarkdown-libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="/rmarkdown-libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Data from the National Fire Incident Reporting System (NFIRS) is now available from the U.S. Fire Administration (USFA) for 2015. The agency collects data reported from the majority of fire departments across the country. While working with fire departments, in my current role, I’ve observed that most reporting agencies provide detailed information about every incident along with times associated with each of the incident’s responding units. Additional details accompany serious fires, mutual aid responses, casualties (injuries and deaths), and assorted special circumstances (such as hazardous materials and wildfires).</p>
<p>In the past, the USFA’s public data release (PDR) would only contain fire incidents, which amounts to a small but significant fraction (8.7% for 2015) of all incidents involving fire departments. Now, you can request information about <strong>all</strong> incidents; however, unit-level information still remains unavailable. Last May, I received a full data set for 2015 and a matching set of data for 2014 as well. You can request your own data set <a href="https://www.usfa.fema.gov/data/statistics/order_download_data.html">here</a>.</p>
<p>I’m excited about the update as this new expanded data set places NFIRS on par with other similar national data sets such as the National Highway and Traffic Safety Administration’s (<a href="https://www.nhtsa.gov/">NHTSA</a>) National Emergency Medical Services Information System (<a href="https://nemsis.org/">NEMSIS</a>) that records emergency medical incidents involving public or private ambulance services throughout the country. Moreover, it allows a researcher to get a fuller picture of any single agency as well as the activities of the fire service as a whole. 2015’s data includes approximately 24.8 million records, while 2014’s original “fires only” data release contained approximately 2.1 million records. Focusing on the country’s largest fire department, the New York Fire Department (NYFD), NFIRS 2015 data includes approximately 557,000 incidents, but only 80,000 fire-specific incidents.</p>
<p>I’d like to take a few moments to discuss the new data set. NFIRS 2015 data presents challenges that arise whenever one deals with larger data sets. In addition, I recently noticed that many agency’s data submissions are incomplete. Nevertheless, I’d like to provide some interesting summary information. Some of this will leverage the newly included information, highlighting medical incidents. Another will emphasize casualty data which is an important focus of the USFA’s statistical analysis; but I’ll expand the scope to include fire injuries as well as fire deaths. At the end, I will include some foods for thought, links to my own analysis for the technically savvy, and hints at further analysis to come.</p>
</div>
<div id="difficulties-associated-with-data-size" class="section level2">
<h2>Difficulties Associated With Data Size</h2>
<p>I usually conduct the majority of my data analysis using the <a href="https://www.r-project.org/">R statistical programming language</a> on a single workstation. This works fine for smaller data sets that can be loaded comfortably into a computer’s RAM. However, the NFIRS 2015 data release includes more than 10 files and contains more than 7 Gigabytes of information. Even looking at files individually, the primary data file alone exceeds 4 Gigabytes in size. I’d like to discuss some reasonable approaches to this specific problem that I plan to explore going forward along with others that I’ve already discarded.</p>
<ul>
<li><strong>Ignoring the problem</strong>: I’m certainly not loading all the data into memory and storing the information as one RData file. It’s just too big for my system.</li>
<li><strong>Standard Relational Database</strong>: It seems clear that USFA is using a standard database to manage it’s own NFIRS data. Here’s why I won’t be reproducing that method.
<ul>
<li>I’ve explored using MySQL and/or MariaDB for this purpose. While useful for me in general, the data loading process for files of this size is still a bit involved.</li>
<li>For a database of this size, with large individual tables, running queries on my home computer is still quite slow.</li>
<li>Cloud hosting is possible but adds an extra layer of effort with limited benefit as I’m not sharing the data with many users.</li>
</ul></li>
<li><strong>Limiting Data</strong>: To accomplish the analysis incorporated in later sections, I’ve chosen to simply read in a <em>very limited</em> portion of the data set. Careful decisions about what is absolutely necessary for an analysis can alleviate problems with data size. At this point, I’m just using <em>read_csv</em> from the <a href="http://readr.tidyverse.org/">readr</a> package. It allows me to selectively load 11 out of 40 columns from the NFIRS 2015 basic incident table. The resulting RDS file, which is a standard internal R format for a single data set (or “data frame”) is less than 90 Megabytes when compared to 4 Gigabytes. Nevertheless, the file still took over 4 minutes to load. Another alternative is using <em>read.csv.sql</em> from the <a href="https://github.com/ggrothendieck/sqldf/blob/master/README.md#Overview">sqldf</a> package.</li>
<li><strong>Drill</strong>: For the next NFIRS-related post, I will likely use <a href="https://drill.apache.org/">Apache Drill</a> for basic queries. It can also convert the current text-delimited data files into a more efficient columnar <a href="https://parquet.apache.org/">Parquet</a> format. I’ve been experimenting with Drill recently and it’s worked quite well for me.<br />
</li>
<li><strong>Athena</strong>: I’m a current Amazon Web Services user and <a href="https://aws.amazon.com/athena/">Athena</a> would allow me a cost-effective way to leverage cloud computing and my <a href="https://aws.amazon.com/s3/">Simple Storage Service (S3)</a> to perform a complicated analysis in a reasonable amount of time. I haven’t explored this option adequately to offer an informed opinion on it.</li>
</ul>
</div>
<div id="basic-information" class="section level2">
<h2>Basic information</h2>
<p>The 2015 NFIRS data set includes approximately 24,991,000 incidents.</p>
<p>In the past, the public data set was limited to only 71 fire incident types which included. In 2015, these fire incident types represented approximately `r RoundThousand(fire.calls). The following table shows these types sorted from most to least frequent. <div id="htmlwidget-1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"filter":"none","data":[["111","412","444","113","131","142","561","463","445","143","151","440","424","400","631","411","100","150","118","154","140","141","462","442","413","114","441","460","130","112","160","132","410","162","422","121","138","116","461","421","480","443","161","632","171","170","420","137","451","122","481","153","471","134","117","123","152","173","423","115","120","163","133","155","164","136","482","135","172","430","431"],["Building fires","Gas leak (natural gas or LPG)","Power line down","Cooking fire, confined to container","Passenger vehicle fire","Brush, or brush and grass mixture fire","Unauthorized burning","Vehicle accident, general cleanup","Arcing, shorted electrical equipment","Grass fire","Outside rubbish, trash or waste fire","Electrical  wiring/equipment problem, other","Carbon monoxide incident","Hazardous condition, other","Authorized controlled burning","Gasoline or other flammable liquid spill","Fire, other","Outside rubbish fire, other","Trash or rubbish fire, contained","Dumpster or other outside trash receptacle fire","Natural vegetation fire, other","Forest, woods or wildland fire","Aircraft standby","Overheated motor","Oil or other combustible liquid spill","Chimney or flue fire, confined to chimney or flue","Heat from short circuit (wiring), defective/worn","Accident, potential accident, other","Mobile property (vehicle) fire, other","Fires in structures other than in a building","Special outside fire, other","Road freight or transport vehicle fire","Flammable gas or liquid condition, other","Outside equipment fire","Chemical spill or leak","Fire in mobile home used as fixed residence","Off-road vehicle or heavy equipment fire","Fuel burner/boiler malfunction, fire confined","Building or structure weakened or collapsed","Chemical hazard (no spill or leak)","Attempted burning, illegal action, other","Light ballast breakdown","Outside storage fire","Prescribed fire","Cultivated grain or crop fire","Cultivated vegetation, crop fire, other","Toxic condition, other","Camper or recreational vehicle (RV) fire","Biological hazard, confirmed or suspected","Fire in motor home, camper, recreational vehicle","Attempt to burn","Construction or demolition landfill fire","Explosive, bomb removal (for bomb scare, use 721)","Water vehicle fire","Commercial Compactor fire, confined to rubbish","Fire in portable building, fixed location","Garbage dump or sanitary landfill fire","Cultivated trees or nursery stock fire","Refrigeration leak","Incinerator overload or malfunction, fire confined","Fire in mobile prop. used as a fixed struc., other","Outside gas or vapor combustion explosion","Rail vehicle fire","Outside stationary compactor/compacted trash fire","Outside mailbox fire","Self-propelled motor home or recreational vehicle","Threat to burn","Aircraft fire","Cultivated orchard or vineyard fire","Radioactive condition, other","Radiation leak, radioactive material"],[269764,205619,135755,122980,113086,97266,96930,96424,82121,80603,77517,71090,68209,56209,52716,45445,44237,36011,31124,30637,29073,27412,23065,21559,19690,19512,18761,18559,17518,14585,13906,13472,9933,9624,9347,9192,7957,7950,6854,4646,4468,4392,3922,3773,3285,3229,2440,2364,2200,2107,1785,1392,1332,1321,1318,1180,1095,1072,1045,975,936,877,606,590,490,426,281,233,132,86,53]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Incident Type<\/th>\n      <th>Description<\/th>\n      <th>Frequency<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 2, 0, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script></p>
<p>It’s reasonable to expect that the department’s with the largest number of calls are also the areas with the largest populations. Below is a list of 100 agencies with the most reported calls. If you live in a highly populated area where the</p>
<div id="htmlwidget-2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"filter":"none","data":[["NY","CA","PA","IL","FL","TX","OH","TX","CA","NV","TX","MD","FL","MD","NC","MD","DC","FL","NV","MO","CO","TX","VA","GA","CA","AZ","TX","GA","MA","TX","FL","GA","VA","CA","OK","CA","TN","FL","CA","CA","CO","FL","FL","TN","AZ","AL","FL","OH","GA","FL","FL","FL","KS","VA","FL","CA","HI","TX","FL","NE","CA","VA","VA","MD","WA","MO","MN","VA","FL","LA","OK","TX","CA","OR","NC","FL","PA","WA","LA","OR","CA","GA","VA","TX","KY","NM","NY","AK","NV","FL","CO","CA","FL","LA","FL","MA","FL","SC","CA","NC"],["24001","19110","51001","CS931","01032","KA926","25009","AW824","30065","03050","DH807","15555","06301","25001","06002","03100","11001","07252","03002","04813","01601","WB901","05900","06001","34090","11223","WP801","04405","25035","GB803","02072","06701","04100","43070","55013","19105","79553","03072","37140","34080","04118","28042","19182","19532","08183","00102","04112","18027","03301","07212","03051","10192","SG111","71000","16072","36193","52000","SP706","10282","01005","15010","08700","81000","24000","27M16","09545","27218","15301","14162","09060","72009","WB701","56020","0485","09213","24012","02231","32M10","36001","0569","33090","03101","76000","PY603","56290","01007","28008","23100","16001","11062","00505","30005","10052","17005","05102","27348","17022","40104","38005","02607"],["FIRE DEPARTMENT OF NEW YORK","LOS ANGELES COUNTY FD","PHILADELPHIA FIRE DEPT","CHICAGO FD","MIAMIDADE FIRE RESCUE","HOUSTON FD","COLUMBUS DIVISION OF FIRE","SAN ANTONIO FD","ORANGE COUNTY FIRE AUTHORITY","CLARK COUNTY FD","DALLAS FRD","MONTGOMERY CTY FIRE DEPT","PALM BEACH CO FIRE RESCUE","BALTIMORE CITY FIRE DEPT","CHARLOTTE FIRE DEPARTMENT","BALTIMORE CO FD","WASHINGTON DC FIREEMS","ORANGE COUNTY FIRE RESCUE","LAS VEGAS FIRE AND RESCUE","KANSAS CITY FIRE DEPT","DENVER FD","FORT WORTH FD","FAIRFAX CO FIRE RESCUE","ATLANTA FIRE RESCUE DEPARTMENT","SACRAMENTO METROPOLITAN FD","TUCSON FIRE","AUSTIN FD","DEKALB COUNTY FIRE RESCUE","BOSTON","EL PASO FD","JACKSONVILLE FIRE RESCUE","GWINNETT CO FIRE EMER SVCS","CHESTERFIELD FIRE EMS","SAN JOSE FD","OKLAHOMA CITY","LOS ANGELES CITY FD","MEMPHIS FIRE DEPARTMENT","TAMPA FIRE RESCUE","SAN DIEGO FIRE RESCUE","SACRAMENTO FD","COLORADO SPRINGS FD","PASCO COUNTY FIRE RESCUE","BREVARD COUNTY FIRE RESCUE","NASHVILLE FIRE DEPARTMENT","MESA FIRE DEPARTMENT","BIRMINGHAM FIRE RESCUE","ST PETERSBURG FIRE RESCUE","CLEVELAND FIRE DEPARTMENT","COBB CO FIRE DEPT","ORLANDO FD","HILLSBOROUGH CO FIRE RESCUE","FT LAUDERDALE FR","WICHITA FIRE DEPARTMENT","NORFOLK FIRERESCUE","SARASOTA COUNTY FIRE DEPT","SAN BERNANDINO COUNTY FD","HONOLULU FIRE DEPARTMENT","CORPUS CHRISTI FD","BROWARD COUNTY FR EMS","OMAHA FIRE RESCUE","KERN CFD","HENRICO CO FIRE RESCUE","VIRGINIA BEACH FIRE DEPT","ANNE ARUNDEL COUNTY FIRE DEPT","TACOMA FIRE DEPT","ST LOUIS FIRE DEPARTMENT","MINNEAPOLIS FIRE DEPT","PRINCE WILLIAM COUNTY FIRE AND","MARION COUNTY FIRE RESCUE","SHREVEPORT FD","TULSA","ARLINGTON FD","VENTURA COUNTY FD","TUALATIN VALLEY FR","RALEIGH FIRE DEPARTMENT","ST LUCIE COUNTY FIRE DIST","PITTSBURGH BUREAU OF FIRE","SPOKANE FIRE DEPT","NEW ORLEANS FIRE DEPT","EUGENE SPRINGFIELD FIRE","RIVERSIDE CFD","CLAYTON CO FIRE EMER SVCS","RICHMOND FIRE EMERG SRVCS","LUBBOCK FD","LOUISVILLE FIRE HQ","ALBUQUERQUE FIRE DEPT","CITY OF ROCHESTER FIRE DEPT","ANCHORAGE FD","RENO FD","ALACHUA COUNTY FIRE RESCUE","AURORA FD","ANAHEIM FD","HOLLYWOOD FIRE RESCUE","BATON ROUGE FIRE DEPT","POLK COUNTY FIRE RESCUE","WORCESTER","SEMINOLE COUNTY EMS FIRE RESCU","COLUMBIA FIRE DEPT","SAN FRANCISCO FD","FAYETTEVILLE FIRE EMERG MGMT"],[557059,359641,279818,276581,244480,207556,154593,147058,123453,121745,118073,115883,115823,114652,114077,113504,112306,110273,109700,106642,106276,103408,96779,96728,91371,86541,85718,81982,81760,78607,77964,74384,72198,69830,69178,68554,68324,67389,66752,66597,64735,64627,64516,64027,62239,59103,57701,57618,56565,54865,54382,54291,54100,53628,53019,52828,52824,51488,48382,47292,46150,44636,43710,43169,43162,43157,41348,41072,40956,40322,40080,39878,39732,39307,38558,37869,37802,37625,37623,37112,36645,36525,36107,35333,34751,34415,33849,33486,33395,33304,32828,32544,32497,32367,32181,32079,31753,31108,30810,29830]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>State<\/th>\n      <th>Fire Department ID<\/th>\n      <th>Name<\/th>\n      <th>Total Calls<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 3, 0, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
<ul>
<li><p>Summary description: total calls/agencies in basic incident table</p></li>
<li><p>Top 10 agencies - by call? by fire? by medical?</p></li>
</ul>
</div>
<div id="medical-percentage" class="section level2">
<h2>Medical percentage</h2>
<p>14,390,000 - Types of calls by agency: fire vs. medical/mva - Top 10 agencies? total calls, total fires, total medical - total fatalities</p>
<!-- leave casualty information for next week: hint at it -->
</div>
<div id="casualty-information-fatality-and-injury" class="section level2">
<h2>Casualty information: Fatality and Injury</h2>
<ul>
<li><p>summary table for ALL agencies? - display a limited number (sort w/ search)</p></li>
<li><p>fatalities vs. injuries - information about injuries</p></li>
</ul>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
</div>
<div id="food-for-thought" class="section level2">
<h2>Food for thought</h2>
<ul>
<li>data-related questions - directed request for comments (on linkedin) - code references to github repository</li>
</ul>
</div>
